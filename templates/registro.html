{% extends "base.html" %}
<!-- Extiende la plantilla base.html, heredando su estructura -->

{% block title %}Registrarse{% endblock %}
<!-- Define el título de la página como "Registrarse" -->

{% block styles %}
<!-- Bloque para incluir estilos personalizados -->
<link rel="stylesheet" href="../static/style_login.css" />
<!-- Enlace a una hoja de estilos CSS externa para el diseño de la página de registro -->
{% endblock %} {% block content %}
<!-- Bloque para el contenido principal de la página -->
<section>
  <!-- Sección principal del contenido -->
  <div class="color"></div>
  <!-- Divs con clase "color" para efectos visuales -->
  <div class="color"></div>
  <div class="color"></div>
  <div class="box">
    <!-- Contenedor principal del formulario de registro -->
    <div class="square" style="--i: 0"></div>
    <!-- Divs con clase "square" para efectos visuales -->
    <div class="square" style="--i: 1"></div>
    <div class="square" style="--i: 2"></div>
    <div class="square" style="--i: 3"></div>
    <div class="square" style="--i: 4"></div>
    <div class="container">
      <!-- Contenedor del formulario -->
      <div class="from">
        <!-- Contenedor del formulario de registro -->
        <br />
        <!-- Salto de línea para espacio visual -->
        <h2>Registrarse</h2>
        <!-- Título del formulario -->
        <form action="/registro" method="post">
          <!-- Formulario que envía datos a la URL "/registro" usando el método POST -->
          <div class="inputBox">
            <!-- Contenedor para el campo de entrada de usuario -->
            <input type="text" name="username" placeholder="Usuario" required />
            <!-- Campo de entrada para el nombre de usuario -->
          </div>
          <div class="inputBox">
            <!-- Contenedor para el campo de entrada de correo electrónico -->
            <input type="email" name="email" placeholder="Correo" required />
            <!-- Campo de entrada para el correo electrónico -->
          </div>
          <div class="inputBox">
            <!-- Contenedor para el campo de entrada de contraseña -->
            <input
              type="password"
              name="password"
              id="password"
              placeholder="Contraseña"
              required
              pattern="^(?=.*[0-9])(?=.*[!@#$%^&*])[a-zA-Z0-9!@#$%^&*]{6,20}$"
              title="Máximo 6 caracteres, incluyendo al menos un número y un signo especial."
            />
            <!-- Campo de entrada para la contraseña con validación de patrón -->
          </div>
          <div class="inputBox">
            <!-- Contenedor para el botón de envío -->
            <input type="submit" value="Registrarse" />
            <!-- Botón para enviar el formulario -->
          </div>
          <p class="forget">
            <!-- Párrafo con enlace para iniciar sesión -->
            ¿Ya tienes una cuenta? <a href="/">Iniciar sesión</a>
            <!-- Enlace para ir a la página de inicio de sesión -->
          </p>
          <!-- Botón de Cerrar Sesión -->
          <a href="{{ url_for('logout') }}" class="logout-button">
            <!-- Enlace para cerrar sesión -->
            <span class="circle" aria-hidden="true">
              <!-- Elemento visual del botón -->
              <span class="icon arrow"></span>
              <!-- Icono del botón -->
            </span>
            <span class="button-text">Cerrar Sesión</span>
            <!-- Texto del botón -->
          </a>
        </form>
        <script>
          <!-- Inicio de la sección de scripts JavaScript -->
          document
            .querySelector("form")
            .addEventListener("submit", function (e) {
              let password = document.getElementById("password").value;
              let regex =
                /^(?=.*[0-9])(?=.*[!@#$%^&*])[a-zA-Z0-9!@#$%^&*]{6,20}$/;

              if (!regex.test(password)) {
                alert(
                  "La contraseña debe tener entre 6 y 20 caracteres, incluir al menos un número y un signo especial."
                );
                e.preventDefault(); // Detiene el envío del formulario
              }
            });

          function cerrarSesion() {
            fetch("{{ url_for('logout') }}") // Llama a la función logout de Flask
              .then(() => {
                window.close(); // Cierra la pestaña del navegador
              })
              .catch((err) => console.error("Error al cerrar sesión:", err));
          }
        </script>
        <!-- Fin de la sección de scripts JavaScript -->
      </div>
    </div>
  </div>
</section>
{% endblock %}
<!-- Fin del bloque de contenido -->
